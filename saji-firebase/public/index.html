<html>

<head>
  <title>NoteStore</title>
</head>

<body>
  <div>
    ユーザー <span id="displayName"></span><br/>
    メールアドレス <span id="email"></span><br/>
    学年 <span id="grade"></span><br/>
  </div>

  <script src="https://www.gstatic.com/firebasejs/5.11.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase-firestore.js"></script>

  <script src="./firebase.config.js"></script>

  <script type="text/javascript">
    <!--
    // firebaseの初期化
    firebase.initializeApp(firebaseConfig)

    const database = firebase.firestore()

    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        (async () => {
          const user = firebase.auth().currentUser;
          const user_data = (await database.collection("users").doc(user.uid).get()).data()

          document.getElementById('displayName').innerHTML = user.displayName
          document.getElementById('email').innerHTML = user.email
          document.getElementById('grade').innerHTML = user_data.grade

        })().catch(function(error) {
          console.log(error)
        })
      } else {
        location.href = './login.html'
      }
    });

    //-->
  </script>
</body>

</html>
